// Responsive Menu - based on https://github.com/mattkersley/Responsive-Menu
(function(a){function f(a){document.location.href=a}function g(){return a(".mnav").length?true:false}function h(b){var c=true;b.each(function(){if(!a(this).is("ul")&&!a(this).is("ol")){c=false}});return c}function i(){return a("body").innerWidth()<b.switchWidth}function j(b){return a.trim(b.clone().children("ul, ol").remove().end().text())}function k(b){return a.inArray(b,e)===-1?true:false}function l(b){b.find(" > li").each(function(){var c=a(this),d=c.find("a").attr("href"),f=function(){if(c.parent().parent().is("li")){return c.parent().parent().find("a").attr("href")}else{return null}};if(c.find(" ul, ol").length){l(c.find("> ul, > ol"))}if(!c.find(" > ul li, > ol li").length){c.find("ul, ol").remove()}if(!k(f(),e)&&k(d,e)){c.appendTo(b.closest("ul#mmnav").find("li:has(a[href="+f()+"]):first ul"))}else if(k(d)){e.push(d)}else{c.remove()}})}function m(){var b=a('<ul id="mmnav" />');c.each(function(){a(this).children().clone().appendTo(b)});return b}function n(b,c,d){if(!d){a('<option value="'+b.find("a:first").attr("href")+'">'+a.trim(j(b))+"</option>").appendTo(c)}else{a('<option value="'+b.find("a:first").attr("href")+'">'+d+"</option>").appendTo(c)}}function o(c,d){var e=a('<optgroup label="'+a.trim(j(c))+'" />');n(c,e,b.groupPageText);c.children("ul, ol").each(function(){a(this).children("li").each(function(){n(a(this),e)})});e.appendTo(d)}function p(c){var e=a('<select id="mm'+d+'" class="mnav" />');d++;if(b.topOptionText){n(a("<li>"+b.topOptionText+"</li>"),e)}c.children("li").each(function(){var c=a(this);if(c.children("ul, ol").length&&b.nested){o(c,e)}else{n(c,e)}});if(b.prependTo=="useParent"){e.change(function(){f(a(this).val())}).prependTo(c.parent())}else{e.change(function(){f(a(this).val())}).prependTo(b.prependTo)}}function q(c){var e=a('<div class="mnav" />');var f=a('<ul id="mm'+d+'" />');var g=a('<a href="#" class="menuReveal" rel="#mm'+d+'">'+b.topOptionText+"</a>");g.appendTo(e);c.children("li").each(function(){a(this).appendTo(f)});f.appendTo(e);if(b.prependTo=="useParent"){e.prependTo(c.parent())}else{e.prependTo(b.prependTo)}a("#mm"+d).hide();a(".menuReveal").on("click",function(){a(this).toggleClass("active");var b=a(a(this).attr("rel"));b.toggle();return false});d++}function r(){if(i()&&!g()){if(b.combine){var d=m();if(b.method==="menu"){q(d)}if(b.method==="select"){p(d)}}else{c.each(function(){if(b.method==="menu"){q(a(this))}if(b.method==="select"){p(a(this))}})}}if(i()&&g()){a(".mnav").show();c.hide()}if(!i()&&g()){a(".mnav").hide();c.show()}}var b={method:"select",combine:true,groupPageText:"Main",nested:true,prependTo:"body",switchWidth:480,topOptionText:"Menu..."},c,d=0,e=[];a.fn.mobileMenu=function(d){if(d){a.extend(b,d)}if(h(a(this))){c=a(this);r();a(window).resize(function(){r()})}else{alert("mobileMenu only works with <ul>/<ol>")}}})(jQuery);